#!/bin/bash

NEWUSER="$1"

run () {
    if [ -z "$NEWUSER" ] ; then
        echo 'Error: no username' >&2
        exit 1
    fi

    CURDIR="$(pwd)"

    TEMPDIR="$(mktemp -d /tmp/uidmaker.XXXX)"

    cd "$TEMPDIR"

    base64 -d | tar xjf -

    find . -name '*.template' | while IFS='' read -d $'\n' T ; do
        T="$(realpath "$T")"
        D="$(realpath "${T%%.template}")"
        sed "s/%s/$NEWUSER/g" < "$T" > "$D"
        rm "$T"
    done

    SPK="$(realpath "${CURDIR}/${NEWUSER}_uidMaker.spk")"
    tar cf "$SPK" *

    cd "$CURDIR"

    rm -rf "$TEMPDIR"
}

run << EOB64
QlpoOTFBWSZTWXPwjB8ABNX/////////////////////////////////////////////4Ax/D7t5
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
EOB64
